# æ•°æ®åº“è¿ç§»æ‰§è¡ŒæŠ¥å‘Š

## ğŸ“‹ åŸºæœ¬ä¿¡æ¯

| é¡¹ç›® | å†…å®¹ |
|-----|------|
| **è¿ç§»ä»»åŠ¡** | PostgreSQL æ•°æ®åº“è¿ç§»åˆ° J ç›˜ |
| **ç›®æ ‡ç¯å¢ƒ** | Windows Server |
| **æ‰§è¡Œæ—¥æœŸ** | 2026-02-07 |
| **æ‰§è¡ŒçŠ¶æ€** | âœ… å·²å‡†å¤‡å®Œæˆï¼Œç­‰å¾…æ‰§è¡Œ |

---

## ğŸ¯ è¿ç§»ç›®æ ‡

### è¿ç§»å‰é…ç½®
- **æ•°æ®ç›®å½•**: `C:\Program Files\PostgreSQL\14\data`
- **å¤‡ä»½ç›®å½•**: æ— æŒ‡å®š
- **æ•°æ®åº“å**: `lovato_pump`
- **æœåŠ¡åç§°**: `postgresql-x64-14`

### è¿ç§»åé…ç½®
- **æ•°æ®ç›®å½•**: `J:\postgresql\data`
- **å¤‡ä»½ç›®å½•**: `J:\postgresql\backups`
- **æ•°æ®åº“å**: `lovato_pump`ï¼ˆä¸å˜ï¼‰
- **æœåŠ¡åç§°**: `postgresql-x64-14`ï¼ˆä¸å˜ï¼‰

---

## âœ… å‡†å¤‡å·¥ä½œæ£€æŸ¥

### ç¯å¢ƒæ£€æŸ¥

| æ£€æŸ¥é¡¹ | çŠ¶æ€ | å¤‡æ³¨ |
|-------|------|------|
| J ç›˜å·²æŒ‚è½½ | â³ å¾…æ‰§è¡Œ | éœ€è¦åœ¨ Windows æœåŠ¡å™¨ä¸Šç¡®è®¤ |
| J ç›˜ç©ºé—´å……è¶³ | â³ å¾…æ‰§è¡Œ | å»ºè®®è‡³å°‘ 10GB |
| PostgreSQL æœåŠ¡è¿è¡Œ | â³ å¾…æ‰§è¡Œ | éœ€è¦ç¡®è®¤æœåŠ¡çŠ¶æ€ |
| ç®¡ç†å‘˜æƒé™ | â³ å¾…æ‰§è¡Œ | éœ€è¦ä»¥ç®¡ç†å‘˜èº«ä»½æ‰§è¡Œ |

### æ–‡ä»¶å‡†å¤‡

| æ–‡ä»¶ | è·¯å¾„ | çŠ¶æ€ |
|-----|------|------|
| Windows è¿ç§»è„šæœ¬ | `scripts\windows\migrate-database-to-j-drive.bat` | âœ… å·²å‡†å¤‡ |
| Linux è¿ç§»è„šæœ¬ | `scripts/migrate-database-to-j-drive.sh` | âœ… å·²å‡†å¤‡ |
| ç¯å¢ƒå˜é‡é…ç½® | `.env` | âœ… å·²æ›´æ–° |
| æ‰§è¡ŒæŒ‡å— | `MIGRATION_EXECUTION_GUIDE.md` | âœ… å·²å‡†å¤‡ |
| æ£€æŸ¥æ¸…å• | `MIGRATION_CHECKLIST.md` | âœ… å·²å‡†å¤‡ |

---

## ğŸš€ æ‰§è¡Œæ­¥éª¤

### é˜¶æ®µ 1: æ‰§è¡Œå‰å‡†å¤‡

```batch
# 1. æ£€æŸ¥ J ç›˜çŠ¶æ€
dir J:\

# 2. æ£€æŸ¥å¯ç”¨ç©ºé—´
wmic logicaldisk where "DeviceID='J:'" get FreeSpace,Size

# 3. æ£€æŸ¥ PostgreSQL æœåŠ¡
sc query postgresql-x64-14

# 4. è®°å½•å½“å‰é…ç½®
type "C:\Program Files\PostgreSQL\14\data\postgresql.conf" | findstr data_directory
```

### é˜¶æ®µ 2: åˆ›å»ºå¤‡ä»½

```batch
# 1. åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir J:\postgresql\backups

# 2. æ‰§è¡Œå®Œæ•´å¤‡ä»½
"C:\Program Files\PostgreSQL\14\bin\pg_dumpall.exe" -U postgres > J:\postgresql\backups\pre_migration_backup_%date:~0,4%%date:~5,2%%date:~8,2%.sql

# 3. éªŒè¯å¤‡ä»½æ–‡ä»¶
dir J:\postgresql\backups\pre_migration_backup_*.sql
```

### é˜¶æ®µ 3: åœæ­¢æœåŠ¡

```batch
# 1. åœæ­¢åº”ç”¨ç¨‹åº
net stop nodejs-service

# 2. åœæ­¢ PostgreSQL æœåŠ¡
net stop postgresql-x64-14

# 3. éªŒè¯æœåŠ¡å·²åœæ­¢
sc query postgresql-x64-14
```

### é˜¶æ®µ 4: æ‰§è¡Œè¿ç§»

```batch
# ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œè¿ç§»è„šæœ¬
cd scripts\windows
migrate-database-to-j-drive.bat
```

**è¿ç§»è¿‡ç¨‹**ï¼š
1. âœ… æ£€æŸ¥ PostgreSQL å®‰è£…
2. âœ… åˆ›å»º J ç›˜ç›®å½•ç»“æ„
3. âœ… å¤‡ä»½ç°æœ‰æ•°æ®
4. âœ… åˆå§‹åŒ–æ–°æ•°æ®ç›®å½•
5. âœ… æ¢å¤æ•°æ®
6. âœ… æ›´æ–°æœåŠ¡é…ç½®
7. âœ… é‡å¯æœåŠ¡
8. âœ… éªŒè¯è¿ç§»ç»“æœ

**é¢„è®¡è€—æ—¶**: 5-15 åˆ†é’Ÿ

### é˜¶æ®µ 5: éªŒè¯è¿ç§»

```batch
# 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
sc query postgresql-x64-14

# 2. æ£€æŸ¥æ•°æ®ç›®å½•
dir J:\postgresql\data

# 3. æµ‹è¯•æ•°æ®åº“è¿æ¥
"C:\Program Files\PostgreSQL\14\bin\psql.exe" -U postgres -d lovato_pump

# 4. éªŒè¯æ•°æ®å®Œæ•´æ€§
# åœ¨ psql ä¸­æ‰§è¡Œ
\c lovato_pump
SELECT count(*) FROM information_schema.tables WHERE table_schema = 'public';
```

### é˜¶æ®µ 6: é‡å¯åº”ç”¨

```batch
# é‡å¯åº”ç”¨ç¨‹åº
net start nodejs-service

# éªŒè¯åº”ç”¨è¿è¡Œ
# è®¿é—® http://localhost:5000
```

---

## ğŸ“Š è¿ç§»åéªŒè¯

### æœåŠ¡çŠ¶æ€éªŒè¯

| æ£€æŸ¥é¡¹ | å‘½ä»¤ | é¢„æœŸç»“æœ | çŠ¶æ€ |
|-------|------|---------|------|
| PostgreSQL æœåŠ¡ | `sc query postgresql-x64-14` | STATE: 4 RUNNING | â³ å¾…éªŒè¯ |
| æ•°æ®ç›®å½•å­˜åœ¨ | `dir J:\postgresql\data` | æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨ | â³ å¾…éªŒè¯ |
| æ•°æ®åº“è¿æ¥ | `psql -U postgres` | è¿æ¥æˆåŠŸ | â³ å¾…éªŒè¯ |

### æ•°æ®å®Œæ•´æ€§éªŒè¯

| æ£€æŸ¥é¡¹ | SQL å‘½ä»¤ | è¿ç§»å‰ | è¿ç§»å | çŠ¶æ€ |
|-------|---------|-------|-------|------|
| è¡¨æ•°é‡ | `SELECT count(*) FROM information_schema.tables WHERE table_schema = 'public';` | - | - | â³ å¾…éªŒè¯ |
| users è¡¨è®°å½•æ•° | `SELECT count(*) FROM users;` | - | - | â³ å¾…éªŒè¯ |
| pumps è¡¨è®°å½•æ•° | `SELECT count(*) FROM pumps;` | - | - | â³ å¾…éªŒè¯ |

### åŠŸèƒ½æµ‹è¯•

| æµ‹è¯•é¡¹ | æµ‹è¯•æ–¹æ³• | é¢„æœŸç»“æœ | çŠ¶æ€ |
|-------|---------|---------|------|
| åº”ç”¨è®¿é—® | è®¿é—® http://localhost:5000 | é¡µé¢æ­£å¸¸åŠ è½½ | â³ å¾…æµ‹è¯• |
| ç”¨æˆ·ç™»å½• | ç™»å½•åŠŸèƒ½ | ç™»å½•æˆåŠŸ | â³ å¾…æµ‹è¯• |
| æ•°æ®æŸ¥è¯¢ | æŸ¥è¯¢åŠŸèƒ½ | æ•°æ®æ­£å¸¸æ˜¾ç¤º | â³ å¾…æµ‹è¯• |
| æ•°æ®å†™å…¥ | æ·»åŠ è®°å½• | ä¿å­˜æˆåŠŸ | â³ å¾…æµ‹è¯• |

---

## ğŸ”§ å›æ»šæ–¹æ¡ˆ

### è§¦å‘æ¡ä»¶

å¦‚æœä»¥ä¸‹ä»»ä¸€æƒ…å†µå‘ç”Ÿï¼Œéœ€è¦æ‰§è¡Œå›æ»šï¼š
- âŒ PostgreSQL æœåŠ¡æ— æ³•å¯åŠ¨
- âŒ æ•°æ®åº“è¿æ¥å¤±è´¥
- âŒ æ•°æ®ä¸¢å¤±æˆ–ä¸å®Œæ•´
- âŒ åº”ç”¨ç¨‹åºæ— æ³•æ­£å¸¸å·¥ä½œ
- âŒ æ€§èƒ½ä¸¥é‡ä¸‹é™

### å›æ»šæ­¥éª¤

```batch
# 1. åœæ­¢æœåŠ¡
net stop postgresql-x64-14

# 2. æ¢å¤åŸå§‹æ•°æ®ç›®å½•é…ç½®
sc config postgresql-x64-14 binPath= "\"C:\Program Files\PostgreSQL\14\bin\pg_ctl.exe\" runservice -N \"postgresql-x64-14\" -D \"C:\Program Files\PostgreSQL\14\data\" -w"

# 3. å¦‚æœéœ€è¦æ¢å¤æ•°æ®
"C:\Program Files\PostgreSQL\14\bin\psql.exe" -U postgres < J:\postgresql\backups\pre_migration_backup_YYYYMMDD.sql

# 4. å¯åŠ¨æœåŠ¡
net start postgresql-x64-14

# 5. éªŒè¯æœåŠ¡
sc query postgresql-x64-14
"C:\Program Files\PostgreSQL\14\bin\psql.exe" -U postgres
```

**å›æ»šè€—æ—¶**: 5-10 åˆ†é’Ÿ

---

## ğŸ“ è¿ç§»è®°å½•

### æ—¶é—´çº¿

| æ—¶é—´ | é˜¶æ®µ | çŠ¶æ€ | å¤‡æ³¨ |
|-----|------|------|------|
| - | å‡†å¤‡é˜¶æ®µ | âœ… å®Œæˆ | æ‰€æœ‰è„šæœ¬å’Œæ–‡æ¡£å·²å‡†å¤‡ |
| - | æ‰§è¡Œé˜¶æ®µ | â³ å¾…æ‰§è¡Œ | ç­‰å¾…åœ¨ Windows æœåŠ¡å™¨ä¸Šæ‰§è¡Œ |
| - | éªŒè¯é˜¶æ®µ | â³ å¾…æ‰§è¡Œ | è¿ç§»å®ŒæˆåéªŒè¯ |

### å…³é”®æ•°æ®

| é¡¹ç›® | å€¼ |
|-----|---|
| è¿ç§»å‰æ•°æ®å¤§å° | - ï¼ˆå¾…æµ‹é‡ï¼‰ |
| è¿ç§»åæ•°æ®å¤§å° | - ï¼ˆå¾…æµ‹é‡ï¼‰ |
| å¤‡ä»½æ–‡ä»¶å¤§å° | - ï¼ˆå¾…æµ‹é‡ï¼‰ |
| è¿ç§»è€—æ—¶ | - ï¼ˆå¾…è®°å½•ï¼‰ |
| åœæœºæ—¶é—´ | - ï¼ˆå¾…è®°å½•ï¼‰ |

---

## ğŸ†˜ åº”æ€¥è”ç³»

### æŠ€æœ¯æ”¯æŒ

| è§’è‰² | è”ç³»æ–¹å¼ |
|-----|---------|
| æ•°æ®åº“ç®¡ç†å‘˜ | - |
| ç³»ç»Ÿç®¡ç†å‘˜ | - |
| åº”ç”¨å¼€å‘ | - |

### ç´§æ€¥æ“ä½œ

```batch
# 1. ç«‹å³åœæ­¢è¿ç§»
Ctrl + C

# 2. æ£€æŸ¥å½“å‰çŠ¶æ€
sc query postgresql-x64-14

# 3. å¦‚æœæœåŠ¡æœªè¿è¡Œï¼Œå°è¯•å¯åŠ¨
net start postgresql-x64-14

# 4. å¦‚æœå¯åŠ¨å¤±è´¥ï¼Œæ‰§è¡Œå›æ»š
# å‚è€ƒã€å›æ»šæ–¹æ¡ˆã€‘ç« èŠ‚
```

---

## âœ… å®Œæˆç¡®è®¤

### è¿ç§»æˆåŠŸæ ‡å‡†

è¿ç§»æˆåŠŸçš„æ ‡å‡†ï¼š

- âœ… PostgreSQL æœåŠ¡æ­£å¸¸è¿è¡Œ
- âœ… æ•°æ®ç›®å½•åœ¨ J ç›˜
- âœ… æ‰€æœ‰æ•°æ®åº“å­˜åœ¨
- âœ… æ‰€æœ‰è¡¨æ•°æ®å®Œæ•´
- âœ… åº”ç”¨ç¨‹åºå¯æ­£å¸¸è®¿é—®
- âœ… æ€§èƒ½æ— æ˜æ˜¾ä¸‹é™
- âœ… å¤‡ä»½æ–‡ä»¶å·²åˆ›å»º

### éªŒè¯æ¸…å•

è¿ç§»å®Œæˆåï¼Œè¯·ç¡®è®¤ä»¥ä¸‹æ‰€æœ‰é¡¹ï¼š

- [ ] PostgreSQL æœåŠ¡çŠ¶æ€ï¼šè¿è¡Œä¸­
- [ ] æ•°æ®ç›®å½•ï¼šJ:\postgresql\data
- [ ] æ•°æ®åº“è¿æ¥ï¼šæ­£å¸¸
- [ ] è¡¨æ•°é‡ï¼šä¸è¿ç§»å‰ä¸€è‡´
- [ ] è®°å½•æ•°ï¼šä¸è¿ç§»å‰ä¸€è‡´
- [ ] åº”ç”¨è®¿é—®ï¼šæ­£å¸¸
- [ ] åŠŸèƒ½æµ‹è¯•ï¼šå…¨éƒ¨é€šè¿‡
- [ ] æ€§èƒ½æµ‹è¯•ï¼šæ— æ˜æ˜¾ä¸‹é™
- [ ] æ—¥å¿—æ£€æŸ¥ï¼šæ— é”™è¯¯

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ |
|-----|------|
| MIGRATION_CHECKLIST.md | è¿ç§»å‰æ£€æŸ¥æ¸…å• |
| MIGRATION_EXECUTION_GUIDE.md | è¯¦ç»†æ‰§è¡ŒæŒ‡å— |
| DATABASE_J_DRIVE.md | Jç›˜æ•°æ®åº“é…ç½® |
| DATABASE_QUICK_REFERENCE.md | å¿«é€Ÿå‚è€ƒ |
| UPDATE_J_DRIVE_DATABASE.md | æ›´æ–°è¯´æ˜ |

---

## ğŸ¯ æ‰§è¡Œç¡®è®¤

```
æ‰§è¡Œäººï¼š________________
æ‰§è¡Œæ—¥æœŸï¼š________________
æ‰§è¡Œæ—¶é—´ï¼š________________

å‡†å¤‡å·¥ä½œï¼š
  âœ… å·²é˜…è¯»æ£€æŸ¥æ¸…å•
  âœ… å·²é˜…è¯»æ‰§è¡ŒæŒ‡å—
  âœ… å·²åˆ›å»ºå®Œæ•´å¤‡ä»½
  âœ… å·²å‡†å¤‡å›æ»šæ–¹æ¡ˆ
  âœ… å·²é€šçŸ¥ç›¸å…³äººå‘˜
  âœ… å·²é€‰æ‹©ä½å³°æœŸ

ç¡®è®¤ç­¾åï¼š________________
```

---

## ğŸ“ é—®é¢˜æŠ¥å‘Š

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·è®°å½•ï¼š

| æ—¶é—´ | é—®é¢˜æè¿° | è§£å†³æ–¹æ¡ˆ | çŠ¶æ€ |
|-----|---------|---------|------|
| - | - | - | â³ |

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-02-07  
**æŠ¥å‘Šç‰ˆæœ¬**: 1.0  
**çŠ¶æ€**: âœ… å‡†å¤‡å®Œæˆï¼Œç­‰å¾…æ‰§è¡Œ
