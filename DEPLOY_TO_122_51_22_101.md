# æ´›ç“¦æ‰˜æ°´æ³µé€‰å‹ç³»ç»Ÿ - éƒ¨ç½²åˆ° 122.51.22.101

## ğŸ“‹ éƒ¨ç½²ä¿¡æ¯

```
æœåŠ¡å™¨: 122.51.22.101
åº”ç”¨åœ°å€: http://122.51.22.101
ç®¡ç†é¢æ¿: http://122.51.22.101/admin

æ•°æ®åº“: 122.51.22.101:5433
ç”¨æˆ·: admin
å¯†ç : Tencent@123
æ•°æ®åº“: mydb
```

---

## ğŸš€ æ–¹å¼ 1ï¼šä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

### å‰ç½®æ¡ä»¶
- âœ… å·²ä¸‹è½½ `lovato-pump-deploy.tar.gz` æ–‡ä»¶
- âœ… å·²å®‰è£… SSH å®¢æˆ·ç«¯ï¼ˆLinux/Mac è‡ªå¸¦ï¼ŒWindows éœ€è¦å®‰è£…ï¼‰
- âœ… æœ‰æœåŠ¡å™¨çš„ SSH è®¿é—®æƒé™ï¼ˆroot ç”¨æˆ·ï¼‰

### éƒ¨ç½²æ­¥éª¤

```bash
# 1. è¿›å…¥éƒ¨ç½²æ–‡ä»¶æ‰€åœ¨ç›®å½•
cd /path/to/lovato-pump-deploy.tar.gz

# 2. æ‰§è¡Œä¸€é”®éƒ¨ç½²è„šæœ¬
bash scripts/one-click-deploy.sh

# 3. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆçº¦ 10-15 åˆ†é’Ÿï¼‰

# 4. è®¿é—®åº”ç”¨
# æµè§ˆå™¨æ‰“å¼€: http://122.51.22.101
```

### éƒ¨ç½²è¿‡ç¨‹è¯´æ˜

è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹æ“ä½œï¼š
1. âœ… æ£€æŸ¥éƒ¨ç½²æ–‡ä»¶
2. âœ… ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨
3. âœ… åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œéƒ¨ç½²
4. âœ… å¯åŠ¨åº”ç”¨å®¹å™¨
5. âœ… é…ç½® Nginx
6. âœ… éªŒè¯éƒ¨ç½²ç»“æœ

---

## ğŸ”§ æ–¹å¼ 2ï¼šæ‰‹åŠ¨éƒ¨ç½²

### æ­¥éª¤ 1ï¼šä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨

```bash
# åœ¨æœ¬åœ°ç”µè„‘æ‰§è¡Œ
scp lovato-pump-deploy.tar.gz root@122.51.22.101:/tmp/
```

### æ­¥éª¤ 2ï¼šSSH ç™»å½•æœåŠ¡å™¨

```bash
ssh root@122.51.22.101
```

### æ­¥éª¤ 3ï¼šè§£å‹é¡¹ç›®æ–‡ä»¶

```bash
# åˆ›å»ºåº”ç”¨ç›®å½•
mkdir -p /opt/lovato-pump

# è§£å‹æ–‡ä»¶
cd /opt/lovato-pump
tar -xzf /tmp/lovato-pump-deploy.tar.gz
mv projects/* .
rm -rf projects
```

### æ­¥éª¤ 4ï¼šæ£€æŸ¥é…ç½®

```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡
cat .env.production

# åº”è¯¥åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š
# DATABASE_URL=postgresql://admin:Tencent@123@122.51.22.101:5433/mydb
# NEXT_PUBLIC_APP_URL=http://122.51.22.101
# SHOW_ADMIN_PANEL=true
```

### æ­¥éª¤ 5ï¼šæ‰§è¡Œè‡ªåŠ¨éƒ¨ç½²

```bash
# æ‰§è¡Œéƒ¨ç½²è„šæœ¬
bash scripts/deploy-tencent-cloud.sh

# æˆ–ä½¿ç”¨ npm è„šæœ¬
pnpm deploy:tencent
```

### æ­¥éª¤ 6ï¼šç­‰å¾…éƒ¨ç½²å®Œæˆ

éƒ¨ç½²è¿‡ç¨‹åŒ…æ‹¬ï¼š
- æ£€æŸ¥ç³»ç»Ÿç¯å¢ƒï¼ˆçº¦ 30 ç§’ï¼‰
- æµ‹è¯•æ•°æ®åº“è¿æ¥ï¼ˆçº¦ 10 ç§’ï¼‰
- æ„å»º Docker é•œåƒï¼ˆçº¦ 8-10 åˆ†é’Ÿï¼‰
- å¯åŠ¨åº”ç”¨å®¹å™¨ï¼ˆçº¦ 1 åˆ†é’Ÿï¼‰
- é…ç½® Nginxï¼ˆçº¦ 30 ç§’ï¼‰

**é¢„è®¡æ€»æ—¶é—´ï¼š10-15 åˆ†é’Ÿ**

### æ­¥éª¤ 7ï¼šéªŒè¯éƒ¨ç½²

```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:5000/api/health

# æµ‹è¯•é¦–é¡µ
curl http://localhost:5000/

# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker logs --tail 50 lovato-pump-app
```

### æ­¥éª¤ 8ï¼šé…ç½®é˜²ç«å¢™

å¦‚æœä½¿ç”¨ ufwï¼š

```bash
# å¼€æ”¾ 80 å’Œ 443 ç«¯å£
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw reload
```

**é‡è¦**ï¼šè¿˜éœ€åœ¨è…¾è®¯äº‘æ§åˆ¶å°é…ç½®é˜²ç«å¢™è§„åˆ™ï¼

### æ­¥éª¤ 9ï¼šé…ç½®è…¾è®¯äº‘é˜²ç«å¢™

1. ç™»å½•è…¾è®¯äº‘æ§åˆ¶å°
2. è¿›å…¥"è½»é‡åº”ç”¨æœåŠ¡å™¨"
3. æ‰¾åˆ°å®ä¾‹ï¼ˆ122.51.22.101ï¼‰
4. ç‚¹å‡»"é˜²ç«å¢™"æ ‡ç­¾
5. æ·»åŠ è§„åˆ™ï¼š
   - ç«¯å£ï¼š80ï¼Œåè®®ï¼šTCPï¼Œæ¥æºï¼š0.0.0.0/0
   - ç«¯å£ï¼š443ï¼Œåè®®ï¼šTCPï¼Œæ¥æºï¼š0.0.0.0/0

### æ­¥éª¤ 10ï¼šè®¿é—®åº”ç”¨

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š

```
http://122.51.22.101
```

---

## ğŸ“Š éƒ¨ç½²å®Œæˆå

### ä¸»è¦è®¿é—®åœ°å€

```
åº”ç”¨ä¸»é¡µ: http://122.51.22.101
æ™ºèƒ½é€‰å‹: http://122.51.22.101/selection
äº§å“åº“: http://122.51.22.101/products
ç®¡ç†é¢æ¿: http://122.51.22.101/admin
```

### API æ¥å£

```
å¥åº·æ£€æŸ¥: http://122.51.22.101/api/health
æ°´æ³µåˆ—è¡¨: http://122.51.22.101/api/pumps
æ™ºèƒ½é€‰å‹: http://122.51.22.101/api/pump/match
```

---

## ğŸ”§ ç®¡ç†å‘½ä»¤

### SSH ç™»å½•

```bash
ssh root@122.51.22.101
```

### æŸ¥çœ‹å®¹å™¨çŠ¶æ€

```bash
cd /opt/lovato-pump
docker-compose ps
```

### æŸ¥çœ‹åº”ç”¨æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹
docker logs -f lovato-pump-app

# æŸ¥çœ‹æœ€æ–° 100 è¡Œ
docker logs --tail 100 lovato-pump-app
```

### é‡å¯åº”ç”¨

```bash
cd /opt/lovato-pump
docker-compose restart
```

### åœæ­¢åº”ç”¨

```bash
cd /opt/lovato-pump
docker-compose stop
```

### å¯åŠ¨åº”ç”¨

```bash
cd /opt/lovato-pump
docker-compose start
```

### æŸ¥çœ‹ Nginx æ—¥å¿—

```bash
sudo tail -f /var/log/nginx/lovato-pump-access.log
sudo tail -f /var/log/nginx/lovato-pump-error.log
```

---

## ğŸ†˜ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šæ— æ³•è®¿é—®åº”ç”¨

**æ£€æŸ¥æ¸…å•ï¼š**

1. æ£€æŸ¥å®¹å™¨æ˜¯å¦è¿è¡Œ
   ```bash
   docker ps | grep lovato-pump
   ```

2. æ£€æŸ¥åº”ç”¨æ—¥å¿—
   ```bash
   docker logs lovato-pump-app
   ```

3. æ£€æŸ¥é˜²ç«å¢™
   ```bash
   sudo ufw status
   ```

4. æ£€æŸ¥è…¾è®¯äº‘é˜²ç«å¢™è§„åˆ™
   - ç™»å½•è…¾è®¯äº‘æ§åˆ¶å°
   - æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ 80/443 ç«¯å£

5. æµ‹è¯•æœ¬åœ°è®¿é—®
   ```bash
   curl http://localhost:5000/api/health
   ```

### é—®é¢˜ 2ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥

**æ£€æŸ¥æ¸…å•ï¼š**

1. æµ‹è¯•æ•°æ®åº“è¿æ¥
   ```bash
   psql -h 122.51.22.101 -p 5433 -U admin -d mydb
   ```

2. æ£€æŸ¥æ•°æ®åº“ç™½åå•
   - ç™»å½•è…¾è®¯äº‘æ§åˆ¶å°
   - è¿›å…¥"è½»é‡æ•°æ®åº“"
   - é…ç½®ç™½åå•ï¼Œæ·»åŠ æœåŠ¡å™¨ IPï¼š122.51.22.101

3. æŸ¥çœ‹ç¯å¢ƒå˜é‡
   ```bash
   docker exec lovato-pump-app env | grep DATABASE_URL
   ```

### é—®é¢˜ 3ï¼šå®¹å™¨å¯åŠ¨å¤±è´¥

**æ£€æŸ¥æ­¥éª¤ï¼š**

1. æŸ¥çœ‹å®¹å™¨æ—¥å¿—
   ```bash
   docker logs lovato-pump-app
   ```

2. æŸ¥çœ‹å®¹å™¨çŠ¶æ€
   ```bash
   docker ps -a | grep lovato-pump
   ```

3. é‡æ–°æ„å»ºé•œåƒ
   ```bash
   cd /opt/lovato-pump
   docker-compose build
   docker-compose up -d
   ```

### é—®é¢˜ 4ï¼šNginx é…ç½®é”™è¯¯

**æ£€æŸ¥æ­¥éª¤ï¼š**

1. æµ‹è¯• Nginx é…ç½®
   ```bash
   sudo nginx -t
   ```

2. æŸ¥çœ‹ Nginx é”™è¯¯æ—¥å¿—
   ```bash
   sudo tail -f /var/log/nginx/error.log
   ```

3. é‡å¯ Nginx
   ```bash
   sudo systemctl restart nginx
   ```

---

## âœ… éƒ¨ç½²éªŒè¯æ¸…å•

éƒ¨ç½²å®Œæˆåï¼Œè¯·éªŒè¯ä»¥ä¸‹é¡¹ç›®ï¼š

- [ ] å¯ä»¥è®¿é—®åº”ç”¨ä¸»é¡µï¼šhttp://122.51.22.101
- [ ] å¯ä»¥è®¿é—®æ™ºèƒ½é€‰å‹é¡µé¢ï¼šhttp://122.51.22.101/selection
- [ ] å¯ä»¥è®¿é—®äº§å“åº“ï¼šhttp://122.51.22.101/products
- [ ] å¯ä»¥è®¿é—®ç®¡ç†é¢æ¿ï¼šhttp://122.51.22.101/admin
- [ ] å¥åº·æ£€æŸ¥æ¥å£æ­£å¸¸ï¼šhttp://122.51.22.101/api/health
- [ ] å®¹å™¨è¿è¡Œæ­£å¸¸ï¼š`docker ps`
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸ï¼šæ£€æŸ¥ç®¡ç†é¢æ¿æ•°æ®åº“çŠ¶æ€
- [ ] Nginx è¿è¡Œæ­£å¸¸ï¼š`sudo systemctl status nginx`

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. é”™è¯¯ä¿¡æ¯æˆªå›¾
2. å®¹å™¨æ—¥å¿—ï¼š`docker logs lovato-pump-app`
3. å®¹å™¨çŠ¶æ€ï¼š`docker ps`
4. Nginx æ—¥å¿—ï¼š`sudo tail -50 /var/log/nginx/lovato-pump-error.log`

---

**éƒ¨ç½²å®Œæˆåï¼Œè®¿é—® http://122.51.22.101 å¼€å§‹ä½¿ç”¨ï¼** ğŸ‰
