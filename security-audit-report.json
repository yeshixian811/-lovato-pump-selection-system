{
  "timestamp": "2026-02-08T07:24:04.299Z",
  "duration": "0.37",
  "totalIssues": 48,
  "criticalIssues": 9,
  "highIssues": 37,
  "mediumIssues": 2,
  "checks": {
    "sqlInjection": {
      "name": "SQLæ³¨å…¥æ¼æ´æ£€æŸ¥",
      "severity": "critical",
      "issues": [
        {
          "file": "/workspace/projects/src/app/api/inventory/customers/route.ts",
          "line": 17,
          "code": "SELECT * FROM customers'\n    const params: any[] = []\n    \n    if (status) {\n      query += ' WHERE status = $1'\n      params.push(status)\n    }\n    \n    query += ' ORDER BY created_at DESC'\n    \n    const result = await db.query(query, params)\n    \n    return NextResponse.json({\n      success: true,\n      data: result.rows\n    })\n  } catch (error) {\n    console.error('è·å–å®¢æˆ·åˆ—è¡¨å¤±è´¥:', error)\n    return NextResponse.json({\n      success: false,\n      message: 'è·å–å®¢æˆ·åˆ—è¡¨å¤±è´¥'\n    }, { status: 500 })\n  }\n}\n\n// åˆ›å»ºå®¢æˆ·ï¼ˆéœ€è¦ç®¡ç†å‘˜æˆ–ç»ç†æƒé™ï¼‰\nexport async function POST(request: NextRequest) {\n  // éªŒè¯æƒé™\n  const authResult = await verifyManagerAuth(request);\n  if (authResult instanceof NextResponse) {\n    return authResult;\n  }\n  \n  try {\n    const body = await request.json()\n    const { code, name, contact_person, phone, email, address, status } = body\n    \n    // ç”Ÿæˆå®¢æˆ·ç¼–ç \n    const customerCode = code || `CUS${Date.now()}`",
          "severity": "critical"
        },
        {
          "file": "/workspace/projects/src/app/api/inventory/purchase/route.ts",
          "line": 44,
          "code": "query('BEGIN')\n    \n    const body = await request.json()\n    const { supplier_id, items, remark } = body\n    \n    // ç”Ÿæˆè®¢å•å·\n    const orderNo = `PO${Date.now()}`",
          "severity": "critical"
        },
        {
          "file": "/workspace/projects/src/app/api/inventory/purchase/route.ts",
          "line": 11,
          "code": "SELECT po.*, s.name as supplier_name\n      FROM purchase_orders po\n      LEFT JOIN suppliers s ON po.supplier_id = s.id\n    `\n    const params: any[] = []\n    \n    if (status) {\n      query += ' WHERE po.status = $1'\n      params.push(status)\n    }\n    \n    query += ' ORDER BY po.created_at DESC'\n    \n    const result = await db.query(query, params)\n    \n    return NextResponse.json({\n      success: true,\n      data: result.rows\n    })\n  } catch (error) {\n    console.error('è·å–é‡‡è´­è®¢å•åˆ—è¡¨å¤±è´¥:', error)\n    return NextResponse.json({\n      success: false,\n      message: 'è·å–é‡‡è´­è®¢å•åˆ—è¡¨å¤±è´¥'\n    }, { status: 500 })\n  }\n}\n\n// åˆ›å»ºé‡‡è´­è®¢å•\nexport async function POST(request: Request) {\n  const client = await db.getClient()\n  \n  try {\n    await client.query('BEGIN')\n    \n    const body = await request.json()\n    const { supplier_id, items, remark } = body\n    \n    // ç”Ÿæˆè®¢å•å·\n    const orderNo = `PO${Date.now()}`",
          "severity": "critical"
        },
        {
          "file": "/workspace/projects/src/app/api/inventory/sales/route.ts",
          "line": 44,
          "code": "query('BEGIN')\n    \n    const body = await request.json()\n    const { customer_id, items, remark } = body\n    \n    // ç”Ÿæˆè®¢å•å·\n    const orderNo = `SO${Date.now()}`",
          "severity": "critical"
        },
        {
          "file": "/workspace/projects/src/app/api/inventory/sales/route.ts",
          "line": 11,
          "code": "SELECT so.*, c.name as customer_name\n      FROM sales_orders so\n      LEFT JOIN customers c ON so.customer_id = c.id\n    `\n    const params: any[] = []\n    \n    if (status) {\n      query += ' WHERE so.status = $1'\n      params.push(status)\n    }\n    \n    query += ' ORDER BY so.created_at DESC'\n    \n    const result = await db.query(query, params)\n    \n    return NextResponse.json({\n      success: true,\n      data: result.rows\n    })\n  } catch (error) {\n    console.error('è·å–é”€å”®è®¢å•åˆ—è¡¨å¤±è´¥:', error)\n    return NextResponse.json({\n      success: false,\n      message: 'è·å–é”€å”®è®¢å•åˆ—è¡¨å¤±è´¥'\n    }, { status: 500 })\n  }\n}\n\n// åˆ›å»ºé”€å”®è®¢å•\nexport async function POST(request: Request) {\n  const client = await db.getClient()\n  \n  try {\n    await client.query('BEGIN')\n    \n    const body = await request.json()\n    const { customer_id, items, remark } = body\n    \n    // ç”Ÿæˆè®¢å•å·\n    const orderNo = `SO${Date.now()}`",
          "severity": "critical"
        },
        {
          "file": "/workspace/projects/src/app/api/inventory/suppliers/route.ts",
          "line": 10,
          "code": "SELECT * FROM suppliers'\n    const params: any[] = []\n    \n    if (status) {\n      query += ' WHERE status = $1'\n      params.push(status)\n    }\n    \n    query += ' ORDER BY created_at DESC'\n    \n    const result = await db.query(query, params)\n    \n    return NextResponse.json({\n      success: true,\n      data: result.rows\n    })\n  } catch (error) {\n    console.error('è·å–ä¾›åº”å•†åˆ—è¡¨å¤±è´¥:', error)\n    return NextResponse.json({\n      success: false,\n      message: 'è·å–ä¾›åº”å•†åˆ—è¡¨å¤±è´¥'\n    }, { status: 500 })\n  }\n}\n\n// åˆ›å»ºä¾›åº”å•†\nexport async function POST(request: Request) {\n  try {\n    const body = await request.json()\n    const { code, name, contact_person, phone, email, address, status } = body\n    \n    // ç”Ÿæˆä¾›åº”å•†ç¼–ç \n    const supplierCode = code || `SUP${Date.now()}`",
          "severity": "critical"
        },
        {
          "file": "/workspace/projects/src/app/api/pumps/init-performance/route.ts",
          "line": 12,
          "code": "execute(`\n        CREATE TABLE IF NOT EXISTS pump_performance_points (\n          id VARCHAR(36) PRIMARY KEY DEFAULT gen_random_uuid(),\n          pump_id VARCHAR(36) NOT NULL REFERENCES pumps(id) ON DELETE CASCADE,\n          flow_rate DECIMAL(10, 2) NOT NULL,\n          head DECIMAL(10, 2) NOT NULL,\n          power DECIMAL(10, 2),\n          efficiency DECIMAL(5, 2),\n          created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n        );\n\n        CREATE INDEX IF NOT EXISTS idx_pump_performance_points_pump_id\n          ON pump_performance_points(pump_id);\n\n        CREATE INDEX IF NOT EXISTS idx_pump_performance_points_flow_rate\n          ON pump_performance_points(flow_rate);\n      `);\n      console.log(\"âœ“ pump_performance_points è¡¨åˆ›å»ºæˆåŠŸ\");\n    } catch (error) {\n      console.error(\"åˆ›å»ºè¡¨å¤±è´¥:\", error);\n      throw error;\n    }\n\n    // è·å–æ‰€æœ‰æ°´æ³µ\n    const allPumps = await db.execute(`\n      SELECT id, flow_rate, head, max_flow, max_head, power, efficiency\n      FROM pumps\n    `);\n\n    console.log(`æ‰¾åˆ° ${allPumps.rows.length} ä¸ªæ°´æ³µï¼Œå¼€å§‹ç”Ÿæˆæ€§èƒ½æ›²çº¿æ•°æ®...`",
          "severity": "critical"
        }
      ],
      "count": 7
    },
    "xss": {
      "name": "XSSæ¼æ´æ£€æŸ¥",
      "severity": "critical",
      "issues": [],
      "count": 0
    },
    "sensitiveData": {
      "name": "æ•æ„Ÿä¿¡æ¯æ³„éœ²æ£€æŸ¥",
      "severity": "high",
      "issues": [
        {
          "file": "/workspace/projects/scripts/security-audit.js",
          "line": 22,
          "code": "console.log(`${color}${message}${colors.reset}`);\n}\n\n// å®‰å…¨æ£€æŸ¥é¡¹ç›®\nconst securityChecks = {\n  // 1. SQLæ³¨å…¥æ£€æŸ¥\n  sqlInjection: {\n    name: 'SQLæ³¨å…¥æ¼æ´æ£€æŸ¥',\n    severity: 'critical',\n    patterns: [\n      /execute\\s*\\(\\s*`[\\s\\S]*?\\$\\{[\\s\\S]*?\\}[\\s\\S]*?`/g,\n      /query\\s*\\(\\s*['\"`][\\s\\S]*?\\$\\{[\\s\\S]*?\\}[\\s\\S]*?['\"`]/g,\n      /SELECT\\s+[\\s\\S]*?\\s+FROM\\s+[\\s\\S]*?\\s+WHERE[\\s\\S]*?=\\s*['\"`][\\s\\S]*?\\$\\{[\\s\\S]*?\\}[\\s\\S]*?['\"`]/g,\n    ],\n  },\n\n  // 2. XSSæ¼æ´æ£€æŸ¥\n  xss: {\n    name: 'XSSæ¼æ´æ£€æŸ¥',\n    severity: 'critical',\n    patterns: [\n      /dangerouslySetInnerHTML\\s*\\(/g,\n      /innerHTML\\s*=\\s*[\\s\\S]*?\\$\\{[\\s\\S]*?\\}/g,\n      /document\\.write\\s*\\(/g,\n    ],\n  },\n\n  // 3. æ•æ„Ÿä¿¡æ¯æ³„éœ²æ£€æŸ¥\n  sensitiveData: {\n    name: 'æ•æ„Ÿä¿¡æ¯æ³„éœ²æ£€æŸ¥',\n    severity: 'high',\n    patterns: [\n      /password\\s*[:=]\\s*['\"`][\\s\\S]*?['\"`]/gi,\n      /api[_-]?key\\s*[:=]\\s*['\"`][\\s\\S]*?['\"`]/gi,\n      /secret\\s*[:=]\\s*['\"`][\\s\\S]*?['\"`]/gi,\n      /token\\s*[:=]\\s*['\"`][\\s\\S]*?['\"`]/gi,\n      /console\\.log\\s*\\(\\s*[\\s\\S]*?password[\\s\\S]*?\\)",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/scripts/security-audit.js",
          "line": 22,
          "code": "console.log(`${color}${message}${colors.reset}`);\n}\n\n// å®‰å…¨æ£€æŸ¥é¡¹ç›®\nconst securityChecks = {\n  // 1. SQLæ³¨å…¥æ£€æŸ¥\n  sqlInjection: {\n    name: 'SQLæ³¨å…¥æ¼æ´æ£€æŸ¥',\n    severity: 'critical',\n    patterns: [\n      /execute\\s*\\(\\s*`[\\s\\S]*?\\$\\{[\\s\\S]*?\\}[\\s\\S]*?`/g,\n      /query\\s*\\(\\s*['\"`][\\s\\S]*?\\$\\{[\\s\\S]*?\\}[\\s\\S]*?['\"`]/g,\n      /SELECT\\s+[\\s\\S]*?\\s+FROM\\s+[\\s\\S]*?\\s+WHERE[\\s\\S]*?=\\s*['\"`][\\s\\S]*?\\$\\{[\\s\\S]*?\\}[\\s\\S]*?['\"`]/g,\n    ],\n  },\n\n  // 2. XSSæ¼æ´æ£€æŸ¥\n  xss: {\n    name: 'XSSæ¼æ´æ£€æŸ¥',\n    severity: 'critical',\n    patterns: [\n      /dangerouslySetInnerHTML\\s*\\(/g,\n      /innerHTML\\s*=\\s*[\\s\\S]*?\\$\\{[\\s\\S]*?\\}/g,\n      /document\\.write\\s*\\(/g,\n    ],\n  },\n\n  // 3. æ•æ„Ÿä¿¡æ¯æ³„éœ²æ£€æŸ¥\n  sensitiveData: {\n    name: 'æ•æ„Ÿä¿¡æ¯æ³„éœ²æ£€æŸ¥',\n    severity: 'high',\n    patterns: [\n      /password\\s*[:=]\\s*['\"`][\\s\\S]*?['\"`]/gi,\n      /api[_-]?key\\s*[:=]\\s*['\"`][\\s\\S]*?['\"`]/gi,\n      /secret\\s*[:=]\\s*['\"`][\\s\\S]*?['\"`]/gi,\n      /token\\s*[:=]\\s*['\"`][\\s\\S]*?['\"`]/gi,\n      /console\\.log\\s*\\(\\s*[\\s\\S]*?password[\\s\\S]*?\\)",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/scripts/test-encryption.js",
          "line": 149,
          "code": "password = 'StrongPassword123!'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/scripts/test-encryption.js",
          "line": 23,
          "code": "console.log(`${color}${message}${colors.reset}`);\n}\n\n// åŠ å¯†é…ç½®\nconst ENCRYPTION_KEY = process.env.ENCRYPTION_KEY || 'test-key-32-characters-long';\nconst ENCRYPTION_ALGORITHM = 'aes-256-gcm';\nconst PBKDF2_ITERATIONS = 100000;\n\nfunction generateKeyFromPassword(password, salt)",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/scripts/test-security.js",
          "line": 80,
          "code": "password: 'admin123'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/scripts/test-security.js",
          "line": 197,
          "code": "password: 'wrongpassword'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/scripts/test-security.js",
          "line": 21,
          "code": "console.log(`${color}${message}${colors.reset}`);\n}\n\nfunction makeRequest(options, data = null) {\n  return new Promise((resolve, reject) => {\n    const req = http.request(options, (res) => {\n      let body = '';\n\n      res.on('data', (chunk) => {\n        body += chunk;\n      });\n\n      res.on('end', () => {\n        try {\n          resolve({\n            statusCode: res.statusCode,\n            headers: res.headers,\n            body: JSON.parse(body),\n          });\n        } catch (error) {\n          resolve({\n            statusCode: res.statusCode,\n            headers: res.headers,\n            body: body,\n          });\n        }\n      });\n    });\n\n    req.on('error', (error) => {\n      reject(error);\n    });\n\n    if (data) {\n      req.write(JSON.stringify(data));\n    }\n\n    req.end();\n  });\n}\n\nasync function testLogin() {\n  log('', colors.reset);\n  log('ğŸ” æµ‹è¯•ç™»å½•è®¤è¯...', colors.blue);\n  log('', colors.reset);\n\n  try {\n    const options = {\n      hostname: 'localhost',\n      port: 5000,\n      path: '/api/auth/login',\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    };\n\n    const data = {\n      username: 'admin',\n      password: 'admin123', // è¯·ä½¿ç”¨å®é™…çš„æµ‹è¯•å¯†ç \n    };\n\n    const response = await makeRequest(options, data)",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/scripts/test-security.js",
          "line": 21,
          "code": "console.log(`${color}${message}${colors.reset}`);\n}\n\nfunction makeRequest(options, data = null) {\n  return new Promise((resolve, reject) => {\n    const req = http.request(options, (res) => {\n      let body = '';\n\n      res.on('data', (chunk) => {\n        body += chunk;\n      });\n\n      res.on('end', () => {\n        try {\n          resolve({\n            statusCode: res.statusCode,\n            headers: res.headers,\n            body: JSON.parse(body),\n          });\n        } catch (error) {\n          resolve({\n            statusCode: res.statusCode,\n            headers: res.headers,\n            body: body,\n          });\n        }\n      });\n    });\n\n    req.on('error', (error) => {\n      reject(error);\n    });\n\n    if (data) {\n      req.write(JSON.stringify(data));\n    }\n\n    req.end();\n  });\n}\n\nasync function testLogin() {\n  log('', colors.reset);\n  log('ğŸ” æµ‹è¯•ç™»å½•è®¤è¯...', colors.blue);\n  log('', colors.reset);\n\n  try {\n    const options = {\n      hostname: 'localhost',\n      port: 5000,\n      path: '/api/auth/login',\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    };\n\n    const data = {\n      username: 'admin',\n      password: 'admin123', // è¯·ä½¿ç”¨å®é™…çš„æµ‹è¯•å¯†ç \n    };\n\n    const response = await makeRequest(options, data);\n\n    if (response.statusCode === 200 && response.body.success && response.body.data.accessToken)",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/src/app/api/auth/login/route.ts",
          "line": 73,
          "code": "console.log('ç™»å½•æˆåŠŸ - åˆ›å»ºToken');\n    console.log('ç™»å½•æˆåŠŸ - ç”¨æˆ·è§’è‰²:', user.role);\n\n    // è¿”å›ç”¨æˆ·ä¿¡æ¯ï¼ˆä¸åŒ…å«å¯†ç ï¼‰\n    const { passwordHash: _, ...userWithoutPassword } = user;\n\n    const response = NextResponse.json({\n      success: true,\n      user: userWithoutPassword,\n      message: 'ç™»å½•æˆåŠŸ',\n      token: token, // åœ¨å“åº”ä¸­è¿”å›tokenä½œä¸ºå¤‡é€‰æ–¹æ¡ˆ\n    }, {\n      status: 200,\n    })",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/src/app/api/auth/login/route.ts",
          "line": 73,
          "code": "console.log('ç™»å½•æˆåŠŸ - åˆ›å»ºToken')",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/src/app/api/auth/login/route.ts",
          "line": 74,
          "code": "console.log('ç™»å½•æˆåŠŸ - ç”¨æˆ·è§’è‰²:', user.role);\n\n    // è¿”å›ç”¨æˆ·ä¿¡æ¯ï¼ˆä¸åŒ…å«å¯†ç ï¼‰\n    const { passwordHash: _, ...userWithoutPassword } = user;\n\n    const response = NextResponse.json({\n      success: true,\n      user: userWithoutPassword,\n      message: 'ç™»å½•æˆåŠŸ',\n      token: token, // åœ¨å“åº”ä¸­è¿”å›tokenä½œä¸ºå¤‡é€‰æ–¹æ¡ˆ\n    }, {\n      status: 200,\n    })",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/src/app/api/user/me/route.ts",
          "line": 18,
          "code": "Token:', token ? '",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/src/app/api/user/me/route.ts",
          "line": 18,
          "code": "console.log('è®¤è¯æ£€æŸ¥ - Token:', token ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');\n\n    if (!token) {\n      console.log('è®¤è¯æ£€æŸ¥å¤±è´¥: æœªæ‰¾åˆ°token');\n      return NextResponse.json(\n        { error: 'æœªç™»å½•' },\n        { status: 401 }\n      );\n    }\n\n    console.log('è®¤è¯æ£€æŸ¥ - å¼€å§‹éªŒè¯token...');\n    // éªŒè¯token\n    const decoded = await verifyToken(token);\n    console.log('è®¤è¯æ£€æŸ¥ - TokenéªŒè¯ç»“æœ:', decoded ? 'æˆåŠŸ' : 'å¤±è´¥');\n    \n    if (!decoded || !decoded.userId) {\n      console.log('è®¤è¯æ£€æŸ¥å¤±è´¥: Tokenæ— æ•ˆæˆ–æ²¡æœ‰userId');\n      return NextResponse.json(\n        { error: 'Tokenæ— æ•ˆ' },\n        { status: 401 }\n      );\n    }\n\n    console.log('è®¤è¯æ£€æŸ¥ - è·å–ç”¨æˆ·ä¿¡æ¯, userId:', decoded.userId);\n    // è·å–ç”¨æˆ·ä¿¡æ¯\n    const user = await userManager.getUserById(decoded.userId);\n    \n    if (!user) {\n      console.log('è®¤è¯æ£€æŸ¥å¤±è´¥: ç”¨æˆ·ä¸å­˜åœ¨');\n      return NextResponse.json(\n        { error: 'ç”¨æˆ·ä¸å­˜åœ¨' },\n        { status: 404 }\n      );\n    }\n\n    console.log('è®¤è¯æ£€æŸ¥æˆåŠŸ: ç”¨æˆ·è§’è‰² =', user.role);\n    // è¿”å›ç”¨æˆ·ä¿¡æ¯ï¼ˆä¸åŒ…å«å¯†ç ï¼‰\n    const { passwordHash: _, ...userWithoutPassword } = user;\n\n    return NextResponse.json({\n      user: userWithoutPassword,\n    })",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/src/app/api/user/me/route.ts",
          "line": 18,
          "code": "console.log('è®¤è¯æ£€æŸ¥ - Token:', token ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨')",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/src/app/api/user/me/route.ts",
          "line": 21,
          "code": "console.log('è®¤è¯æ£€æŸ¥å¤±è´¥: æœªæ‰¾åˆ°token')",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/src/app/api/user/me/route.ts",
          "line": 28,
          "code": "console.log('è®¤è¯æ£€æŸ¥ - å¼€å§‹éªŒè¯token...')",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/src/app/api/user/me/route.ts",
          "line": 31,
          "code": "console.log('è®¤è¯æ£€æŸ¥ - TokenéªŒè¯ç»“æœ:', decoded ? 'æˆåŠŸ' : 'å¤±è´¥')",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/src/app/api/user/me/route.ts",
          "line": 34,
          "code": "console.log('è®¤è¯æ£€æŸ¥å¤±è´¥: Tokenæ— æ•ˆæˆ–æ²¡æœ‰userId')",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/src/app/products/page.tsx",
          "line": 336,
          "code": "Password=\"yezi100243\"",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/src/lib/db.ts",
          "line": 50,
          "code": "console.log('æ•°æ®åº“é…ç½®:', {\n  host: config.host,\n  port: config.port,\n  user: config.user,\n  database: config.database,\n})\n\nconst pool = new Pool({\n  host: config.host,\n  port: config.port,\n  user: config.user,\n  password: config.password,\n  database: config.database,\n  // è¿æ¥æ± é…ç½®\n  max: 20,\n  idleTimeoutMillis: 30000,\n  connectionTimeoutMillis: 2000,\n})",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/src/storage/database/create-super-admin.ts",
          "line": 18,
          "code": "console.log(\"è¶…çº§ç®¡ç†å‘˜å·²å­˜åœ¨ï¼Œè·³è¿‡åˆ›å»º\");\n      return;\n    }\n\n    // ç”Ÿæˆå¯†ç å“ˆå¸Œï¼ˆå¯†ç ï¼šadmin123ï¼‰\n    const passwordHash = await bcrypt.hash(\"admin123\", 10)",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/api/auth.test.ts",
          "line": 97,
          "code": "password: 'password123'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/auth.test.ts",
          "line": 110,
          "code": "password = 'MySecurePassword123!'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/auth.test.ts",
          "line": 110,
          "code": "password = 'MySecurePassword123!'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/auth.test.ts",
          "line": 110,
          "code": "password = 'MySecurePassword123!'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/auth.test.ts",
          "line": 130,
          "code": "Password = 'WrongPassword123!'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/auth.test.ts",
          "line": 139,
          "code": "password = 'SamePassword123!'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/auth.test.ts",
          "line": 55,
          "code": "Token = 'invalid.token.string'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/encryption.test.ts",
          "line": 22,
          "code": "Password = 'test-encryption-password-123'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/encryption.test.ts",
          "line": 98,
          "code": "apiKey: 'secret-api-key-123'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/encryption.test.ts",
          "line": 265,
          "code": "secret = 'secret-key'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/encryption.test.ts",
          "line": 265,
          "code": "secret = 'secret-key'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/encryption.test.ts",
          "line": 265,
          "code": "secret = 'secret-key'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/encryption.test.ts",
          "line": 265,
          "code": "secret = 'secret-key'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/encryption.test.ts",
          "line": 292,
          "code": "Secret = 'wrong-secret'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/lib/encryption.test.ts",
          "line": 300,
          "code": "secret = 'same-secret'",
          "severity": "high"
        },
        {
          "file": "/workspace/projects/tests/setup.ts",
          "line": 7,
          "code": "SECRET = 'test-jwt-secret-key-for-testing-only'",
          "severity": "high"
        }
      ],
      "count": 37
    },
    "hardcodedCredentials": {
      "name": "ç¡¬ç¼–ç å‡­è¯æ£€æŸ¥",
      "severity": "critical",
      "issues": [
        {
          "file": "/workspace/projects/scripts/validate-env.js",
          "line": 36,
          "code": "postgresql://ç”¨æˆ·å:å¯†ç @",
          "severity": "critical"
        },
        {
          "file": "/workspace/projects/tests/setup.ts",
          "line": 9,
          "code": "postgresql://test:test@",
          "severity": "critical"
        }
      ],
      "count": 2
    },
    "insecureRandom": {
      "name": "ä¸å®‰å…¨çš„éšæœºæ•°æ£€æŸ¥",
      "severity": "medium",
      "issues": [
        {
          "file": "/workspace/projects/src/app/api/payment/create/route.ts",
          "line": 89,
          "code": "Math.random()",
          "severity": "medium"
        },
        {
          "file": "/workspace/projects/src/app/api/storage/upload/route.ts",
          "line": 50,
          "code": "Math.random()",
          "severity": "medium"
        }
      ],
      "count": 2
    },
    "weakEncryption": {
      "name": "å¼±åŠ å¯†ç®—æ³•æ£€æŸ¥",
      "severity": "high",
      "issues": [],
      "count": 0
    },
    "unsafeRedirect": {
      "name": "ä¸å®‰å…¨çš„é‡å®šå‘æ£€æŸ¥",
      "severity": "high",
      "issues": [],
      "count": 0
    },
    "csrfProtection": {
      "name": "CSRFä¿æŠ¤æ£€æŸ¥",
      "severity": "medium",
      "issues": [],
      "count": 0
    },
    "pathTraversal": {
      "name": "æ–‡ä»¶è·¯å¾„éå†æ£€æŸ¥",
      "severity": "critical",
      "issues": [],
      "count": 0
    },
    "insecureEval": {
      "name": "ä¸å®‰å…¨çš„evalæ£€æŸ¥",
      "severity": "critical",
      "issues": [],
      "count": 0
    }
  }
}